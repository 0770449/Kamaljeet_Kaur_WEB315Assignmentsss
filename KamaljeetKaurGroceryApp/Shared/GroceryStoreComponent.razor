@{
    if (ShowAddFoodForm)
    {
        <h3>Add Food Items to an Isle</h3>
        <form>
            <section>             
                    <label for="foodName">Foodname</label>
                    <input type="text"   name="foodName" @bind="foodNameInput"><br/>
                    <label for="ProductionCountry">ProductionCountry</label>
                    <input type="text"  name="ProductionCountry" @bind="ProductionCountryInput"><br/>
                    <label for="Price"> Price</label>
                    <input type="number"  name="Price" @bind="PriceInput"><br/>
                    <label for="color">Color</label>
                    <input type="text"   name="color" @bind="ColorInput"><br/>
                    <label for="quantity">Quantity</label>
                    <input type="number"  min="0" max="20" name="quantity" @bind="quantityInput" required><br/>
                 
                <section> 
                      <label for="isleNumber">Isle number</label>
                      <input type="number" name="isleNumber" @bind="isleInput" required>
                </section>
            </section>
                <button type="button" class="btn btn-primary mt-2" @onclick="AddNewFoodItem">Add New Food Item</button>
        </form>
    }
}<br>

@foreach (var isle in islesList)
{
    
    <table class="table table-hover">
        <thead>
        <tr>
            <th>FoodItem</th>
            <th>ProductionCountry</th>
            <th>Price</th>
            <th>Color</th>
            <th>Quantity</th>
            <th>Buttons</th>
        </tr>
        </thead>
        <tbody>
            @foreach (var foodItem in isle.ListofFoodItems)
            {
                <tr>
                    <td>@foodItem.FoodName</td>
                    <td>@foodItem.ProductionCountry</td>
                    <td>@foodItem.Price</td>
                    <td>@foodItem.Color</td>
                    <td>@foodItem.Quantity</td>
                    <td>
                        <button class="btn btn-decrement" @onclick="() => DecreaseQuantity(foodItem, isle.IsleNumber)">
                        <span class="oi oi-minus" aria-hidden="true"></span></button>
                        <button class="btn btn-increment" @onclick="() => IncreaseQuantity(foodItem, isle.IsleNumber)">
                        <span class="oi oi-plus" aria-hidden="true"></span></button>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}


@code
{   
    [Parameter]
    public bool ShowAddFoodForm { get; set; }
    private string isleInput;
    private string foodNameInput;
    private string ProductionCountryInput;
    private string PriceInput;
    private string ColorInput;

    private string quantityInput;
    private List<GroceryIsle> islesList = new ()
        {
            new GroceryIsle("DairyProducts", 1, new List<FoodItem>()
            {
                
                new FoodItem {FoodName = "Milk", Quantity = 15, ProductionCountry = "Canada", Price = 4f, Color="White"},
                new FoodItem {FoodName = "Curd", Quantity = 5, ProductionCountry= "India", Price = 7f, Color="White"},
            }),
           
            new GroceryIsle("Sweets", 2, new List<FoodItem>()
            {
                new FoodItem {FoodName = "Gulab-jamun", Quantity = 17, ProductionCountry = "India", Price = 5.4f, Color="Brown"},
                new FoodItem {FoodName = "Ladoo", Quantity = 9, ProductionCountry = "India", Price = 4f, Color="Yellow"}
            }),
             new GroceryIsle("Drinks", 3, new List<FoodItem>()
            {
                new FoodItem {FoodName = "Mango-juice", Quantity = 13, ProductionCountry = "Canada", Price = 6f, Color="Yellow"},
                new FoodItem {FoodName = "Apple-juice", Quantity = 16, ProductionCountry = "Tirana", Price = 9.7f, Color="Red"}
            })
        };
// Make sure each food item has a quantity above 0 but below 20 set.
    private void IncreaseQuantity (FoodItem foodItem, float isleNumber)
    {
        var foundIsle = islesList.Find(isle => isle.IsleNumber == isleNumber);
        var foundFood = foundIsle.ListofFoodItems.Find(food => food.FoodName == foodItem.FoodName);

        if (foundFood.Quantity >= 20) return;
 
        foundFood.Quantity += 1;
    }
     private void DecreaseQuantity (FoodItem foodItem, float isleNumber)
    {
        var foundIsle = islesList.Find(isle => isle.IsleNumber == isleNumber);
        var foundFood = foundIsle.ListofFoodItems.Find(food => food.FoodName == foodItem.FoodName);

        if (foundFood.Quantity <= 0) return;

        foundFood.Quantity -= 1;
    }

    private void AddNewFoodItem ()
    {
        if (string.IsNullOrWhiteSpace(isleInput)) return;  //cheacking for whitespace or Is null
        if (string.IsNullOrWhiteSpace(foodNameInput)) return;
        if (string.IsNullOrWhiteSpace(ProductionCountryInput)) return;
        if (string.IsNullOrWhiteSpace(PriceInput)) return;
        if (string.IsNullOrWhiteSpace(ColorInput)) return;
        if (string.IsNullOrWhiteSpace(quantityInput)) return;

        FoodItem newFoodItem = new FoodItem 
            {
                 Quantity = float.Parse(quantityInput),
                FoodName = foodNameInput,
                ProductionCountry= ProductionCountryInput,
                Price = float.Parse(PriceInput),
                Color= ColorInput,
            };

        isleInput = "";  // string.Empty;
        foodNameInput = "";
        ProductionCountryInput = "";
        PriceInput = "";
        ColorInput="";
        quantityInput = "";
    }
}